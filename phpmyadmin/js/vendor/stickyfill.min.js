'use strict';let seppuku=!1;const isWindowDefined=typeof window!='undefined';if(!isWindowDefined||!window.getComputedStyle)seppuku=!0;else{const a=document.createElement('div');['','-webkit-','-moz-','-ms-'].some(b=>{try{a.style.position=b+'sticky'}catch(a){}return a.style.position!=''})&&(seppuku=!0)}let isInitialized=!1;const shadowRootExists=typeof ShadowRoot!='undefined',scroll={top:null,left:null},stickies=[];function extend(c,a){for(var b in a)a.hasOwnProperty(b)&&(c[b]=a[b])}function parseNumeric(a){return parseFloat(a)||0}function getDocOffsetTop(a){let b=0;while(a)b+=a.offsetTop,a=a.offsetParent;return b}class Sticky{constructor(a){if(!(a instanceof HTMLElement))throw new Error('First argument must be HTMLElement');if(stickies.some(b=>b._node===a))throw new Error('Stickyfill is already applied to this node');this._node=a,this._stickyMode=null,this._active=!1,stickies.push(this),this.refresh()}refresh(){if(seppuku||this._removed)return;this._active&&this._deactivate();const a=this._node,b=getComputedStyle(a),c={position:b.position,top:b.top,display:b.display,marginTop:b.marginTop,marginBottom:b.marginBottom,marginLeft:b.marginLeft,marginRight:b.marginRight,cssFloat:b.cssFloat};if(isNaN(parseFloat(c.top))||c.display=='table-cell'||c.display=='none')return;this._active=!0;const l=a.style.position;(b.position=='sticky'||b.position=='-webkit-sticky')&&(a.style.position='static');const h=a.parentNode,e=shadowRootExists&&h instanceof ShadowRoot?h.host:h,d=a.getBoundingClientRect(),i=e.getBoundingClientRect(),f=getComputedStyle(e);this._parent={node:e,styles:{position:e.style.position},offsetHeight:e.offsetHeight},this._offsetToWindow={left:d.left,right:document.documentElement.clientWidth-d.right},this._offsetToParent={top:d.top-i.top-parseNumeric(f.borderTopWidth),left:d.left-i.left-parseNumeric(f.borderLeftWidth),right:-d.right+i.right-parseNumeric(f.borderRightWidth)},this._styles={position:l,top:a.style.top,bottom:a.style.bottom,left:a.style.left,right:a.style.right,width:a.style.width,marginTop:a.style.marginTop,marginLeft:a.style.marginLeft,marginRight:a.style.marginRight};const j=parseNumeric(c.top);this._limits={start:d.top+window.pageYOffset-j,end:i.top+window.pageYOffset+e.offsetHeight-parseNumeric(f.borderBottomWidth)-a.offsetHeight-j-parseNumeric(c.marginBottom)};const k=f.position;k!='absolute'&&k!='relative'&&(e.style.position='relative'),this._recalcPosition();const g=this._clone={};g.node=document.createElement('div'),extend(g.node.style,{width:d.right-d.left+'px',height:d.bottom-d.top+'px',marginTop:c.marginTop,marginBottom:c.marginBottom,marginLeft:c.marginLeft,marginRight:c.marginRight,cssFloat:c.cssFloat,padding:0,border:0,borderSpacing:0,fontSize:'1em',position:'static'}),h.insertBefore(g.node,a),g.docOffsetTop=getDocOffsetTop(g.node)}_recalcPosition(){if(!this._active||this._removed)return;const a=scroll.top<=this._limits.start?'start':scroll.top>=this._limits.end?'end':'middle';if(this._stickyMode==a)return;switch(a){case'start':extend(this._node.style,{position:'absolute',left:this._offsetToParent.left+'px',right:this._offsetToParent.right+'px',top:this._offsetToParent.top+'px',bottom:'auto',width:'auto',marginLeft:0,marginRight:0,marginTop:0});break;case'middle':extend(this._node.style,{position:'fixed',left:this._offsetToWindow.left+'px',right:this._offsetToWindow.right+'px',top:this._styles.top,bottom:'auto',width:'auto',marginLeft:0,marginRight:0,marginTop:0});break;case'end':extend(this._node.style,{position:'absolute',left:this._offsetToParent.left+'px',right:this._offsetToParent.right+'px',top:'auto',bottom:0,width:'auto',marginLeft:0,marginRight:0});break}this._stickyMode=a}_fastCheck(){if(!this._active||this._removed)return;(Math.abs(getDocOffsetTop(this._clone.node)-this._clone.docOffsetTop)>1||Math.abs(this._parent.node.offsetHeight-this._parent.offsetHeight)>1)&&this.refresh()}_deactivate(){if(!this._active||this._removed)return;this._clone.node.parentNode.removeChild(this._clone.node),delete this._clone,extend(this._node.style,this._styles),delete this._styles,stickies.some(a=>a!==this&&a._parent&&a._parent.node===this._parent.node)||extend(this._parent.node.style,this._parent.styles),delete this._parent,this._stickyMode=null,this._active=!1,delete this._offsetToWindow,delete this._offsetToParent,delete this._limits}remove(){this._deactivate(),stickies.some((a,b)=>{if(a._node===this._node)return stickies.splice(b,1),!0}),this._removed=!0}}const Stickyfill={stickies,Sticky,forceSticky(){seppuku=!1,init(),this.refreshAll()},addOne(a){if(!(a instanceof HTMLElement))if(a.length&&a[0])a=a[0];else return;for(var b=0;b<stickies.length;b++)if(stickies[b]._node===a)return stickies[b];return new Sticky(a)},add(a){if(a instanceof HTMLElement&&(a=[a]),!a.length)return;const b=[];for(let c=0;c<a.length;c++){const d=a[c];if(!(d instanceof HTMLElement)){b.push(void 0);continue}if(stickies.some(a=>{if(a._node===d)return b.push(a),!0}))continue;b.push(new Sticky(d))}return b},refreshAll(){stickies.forEach(a=>a.refresh())},removeOne(a){if(!(a instanceof HTMLElement))if(a.length&&a[0])a=a[0];else return;stickies.some(b=>{if(b._node===a)return b.remove(),!0})},remove(a){if(a instanceof HTMLElement&&(a=[a]),!a.length)return;for(let b=0;b<a.length;b++){const c=a[b];stickies.some(a=>{if(a._node===c)return a.remove(),!0})}},removeAll(){while(stickies.length)stickies[0].remove()}};function init(){if(isInitialized)return;isInitialized=!0;function d(){window.pageXOffset!=scroll.left?(scroll.top=window.pageYOffset,scroll.left=window.pageXOffset,Stickyfill.refreshAll()):window.pageYOffset!=scroll.top&&(scroll.top=window.pageYOffset,scroll.left=window.pageXOffset,stickies.forEach(a=>a._recalcPosition()))}d(),window.addEventListener('scroll',d),window.addEventListener('resize',Stickyfill.refreshAll),window.addEventListener('orientationchange',Stickyfill.refreshAll);let e;function c(){e=setInterval(function(){stickies.forEach(a=>a._fastCheck())},500)}function f(){clearInterval(e)}let a,b;'hidden'in document?(a='hidden',b='visibilitychange'):'webkitHidden'in document&&(a='webkitHidden',b='webkitvisibilitychange'),b?(document[a]||c(),document.addEventListener(b,()=>{document[a]?f():c()})):c()}seppuku||init(),typeof module!='undefined'&&module.exports?module.exports=Stickyfill:isWindowDefined&&(window.Stickyfill=Stickyfill)